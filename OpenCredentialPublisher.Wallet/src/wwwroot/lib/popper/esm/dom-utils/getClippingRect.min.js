import{viewport}from"../enums.js";import getViewportRect from"./getViewportRect.js";import getDocumentRect from"./getDocumentRect.js";import listScrollParents from"./listScrollParents.js";import getOffsetParent from"./getOffsetParent.js";import getDocumentElement from"./getDocumentElement.js";import getComputedStyle from"./getComputedStyle.js";import{isElement,isHTMLElement}from"./instanceOf.js";import getBoundingClientRect from"./getBoundingClientRect.js";import getParentNode from"./getParentNode.js";import contains from"./contains.js";import getNodeName from"./getNodeName.js";import rectToClientRect from"../utils/rectToClientRect.js";import{max,min}from"../utils/math.js";function getInnerBoundingClientRect(t){var e=getBoundingClientRect(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}function getClientRectFromMixedType(t,e){return e===viewport?rectToClientRect(getViewportRect(t)):isHTMLElement(e)?getInnerBoundingClientRect(e):rectToClientRect(getDocumentRect(getDocumentElement(t)))}function getClippingParents(t){var e=listScrollParents(getParentNode(t)),o=["absolute","fixed"].indexOf(getComputedStyle(t).position)>=0&&isHTMLElement(t)?getOffsetParent(t):t;return isElement(o)?e.filter(function(t){return isElement(t)&&contains(t,o)&&"body"!==getNodeName(t)}):[]}export default function getClippingRect(t,e,o){var n="clippingParents"===e?getClippingParents(t):[].concat(e),i=[].concat(n,[o]),r=i[0],m=i.reduce(function(e,o){var n=getClientRectFromMixedType(t,o);return e.top=max(n.top,e.top),e.right=min(n.right,e.right),e.bottom=min(n.bottom,e.bottom),e.left=max(n.left,e.left),e},getClientRectFromMixedType(t,r));return m.width=m.right-m.left,m.height=m.bottom-m.top,m.x=m.left,m.y=m.top,m};